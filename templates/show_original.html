<!-- templates/show_original.html -->
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>图表展示</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/mdui.min.css') }}"/>
    <script src="{{ url_for('static', filename='webjs/mdui.min.js') }}"></script>
    <script src="{{ url_for('static', filename='webjs/jquery-3.3.1.min.js') }}"></script>
    {% for jsfile_name in script_list %}
        <script src="{{ host }}/{{ jsfile_name }}.js"></script>
    {% endfor %}
    <style>
        .card { padding: 20px; display: inline-block; position: relative!important; margin: 20px; border-radius: 10px; float: left; overflow: hidden; }
    </style>
</head>
<body>
<div class="navbar"> <a href="/" class="nav-button">返回主页</a> </div>
<div class="mdui-tab mdui-color-cyan" mdui-tab style="font-weight: 600;color: white!important;letter-spacing: 0.2em;height:50px ">
    <a href="#tab-jobs" class="mdui-ripple mdui-tab-active">岗位</a>
    <a href="#tab-salary" class="mdui-ripple">薪水</a>
    <a href="#tab-region" class="mdui-ripple">地区</a>
    <a href="#tab-req" class="mdui-ripple">学历经验</a>
</div>

<div id="tab-jobs" class="mdui-p-a-2">
    <div class="mdui-card card" id="chart-container-0" style="width: 45%; height: 450px;"></div>
    <div class="mdui-card card" id="chart-container-17" style="width: 45%; height: 450px;"></div>
    <div class="mdui-card card" id="chart-container-14" style="width: 45%; height: 450px;"></div>
    <div class="mdui-card card" id="chart-container-1" style="width: 45%; height: 450px;"></div>
</div>
<div id="tab-salary" class="mdui-p-a-2">
    <div class="mdui-card card" id="chart-container-13" style="width: 45%; height: 450px;"></div>
    <div class="mdui-card card" id="chart-container-11" style="width: 45%; height: 450px;"></div>
    <div class="mdui-card card" id="chart-container-7" style="width: 92%; height: 500px;"></div>
</div>
<div id="tab-region" class="mdui-p-a-2">
    <div class="mdui-card card" id="chart-container-15" style="width: 45%; height: 450px;"></div>
    <div class="mdui-card card" id="chart-container-3" style="width: 45%; height: 450px;"></div>
    <div class="mdui-card card" id="chart-container-4" style="width: 45%; height: 450px;"></div>
    <div class="mdui-card card" id="chart-container-2" style="width: 92%; height: 600px;"></div>
</div>
<div id="tab-req" class="mdui-p-a-2">
    <div class="mdui-card card" id="chart-container-5" style="width: 92%; height: 600px;"></div>
    <div class="mdui-card card" id="chart-container-9" style="width: 92%; height: 500px;"></div>
    <div class="mdui-card card" id="chart-container-10" style="width: 45%; height: 450px;"></div>
</div>

</body>
<style>
    .navbar { position: fixed; top: 0; left: 0; width: 100%; background-color: #333; padding: 10px 20px; z-index: 1000; }
    .nav-button { color: white; text-decoration: none; padding: 8px 15px; }
    body { padding-top: 60px; }
</style>
<script>
    function loadChartsForTab(tabId) {
        $(tabId + ' .card').each(function() {
            const chartId = $(this).attr('id').replace('chart-container-', '');
            const container = $(this);
            if (container.data('loaded')) return;
            
            $.ajax({
                type: "GET",
                url: '/chart/' + chartId,
                dataType: "html",
                success: function (data) {
                    container.html(data).data('loaded', true);
                },
                error: function (e) {
                    container.html(`<p style="color:red; text-align:center;">图表加载失败 (ID: ${chartId})</p>`);
                }
            });
        });
    }

    $(document).ready(function() {
        const initialTab = $('.mdui-tab-active').attr('href');
        loadChartsForTab(initialTab);
        $('.mdui-tab a').on('click', function() {
            const tabId = $(this).attr('href');
            loadChartsForTab(tabId);
        });
    });
</script>
</html>